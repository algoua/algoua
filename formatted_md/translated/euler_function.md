# Функція Ейлера

## Визначення

**Функція Ейлера** $\phi (n)$ (іноді обозначаемая $\varphi(n)$ або ${\it phi}(n)$) - це кількість чисел від $1$ до $n$, взаємно простих з $n$. Іншими словами, це кількість таких чисел в відрізку $[1; n]$, [найбільший загальний дільник](euclid_algorithm) яких з $n$ рівний одиниці.

Несколько перших значень цій функції ([A000010 в энциклопедии OEIS](http://oeis.org/A000010)):

$$ \phi (1)=1, $$
$$ \phi (2)=1, $$
$$ \phi (3)=2, $$
$$ \phi (4)=2, $$
$$ \phi (5)=4. $$

## Властивості

Три наступних простих властивості функції Ейлера - достаточны, аби навчитися обчислювати її для будь-яких чисел:

* Якщо $p$ - просте число, то $\phi (p)=p-1$.

(Це очевидно, т.до. будь-яке число, крім самого $p$, взаємно просто з ним).

* Якщо $p$ - просте, $a$ - натуральне число, то $\phi (p^a)=p^a-p^{a-1}$.

(Оскільки з числом $p^a$ не взаємно прості тільки числа увазі $pk$ $(k \in \mathcal{N})$, яких $p^a / p = p^{a-1}$ штук).

* Якщо $a$ і $b$ взаємно прості, то $\phi(ab) = \phi(a) \phi(b)$ ("мультипликативность" функції Ейлера).

(Цей факт випливає з [китайской теореми про залишки](chinese_theorem). Розглянемо довільне число $z \le ab$. Позначимо через $x$ і $y$ остатки від ділення $z$ на $a$ і $b$ відповідно. Значить $z$ взаємно просто з $ab$ тоді і тільки тоді, коли $z$ взаємно просто з $a$ і з $b$ по окремо, або, що то ж саме, $x$ взаємно просто з $a$ і $y$ взаємно просто з $b$. Применяя китайскую теорему про залишки, отримуємо, що будь-якої пари чисел $x$ і $y$ $(x \le a, ~ y \le b)$ взаємно однозначно відповідає число $z$ $(z \le ab)$, що і завершує доведення).

Звідси можна получити функцію Ейлера для будь-якого $\it n$ через його **факторизацію** (розкладання $n$ на прості сомножители):

якщо

$$ n = p_1^{a_1} \cdot p_2^{a_2} \cdot \ldots \cdot p_k^{a_k} $$

(де всі $p_i$ - прості), то

$$ \phi(n) = \phi(p_1^{a_1}) \cdot \phi(p_2^{a_2}) \cdot \ldots \cdot \phi(p_k^{a_k}) = $$
$$ = (p_1^{a_1} - p_1^{a_1-1}) \cdot (p_2^{a_2} - p_2^{a_2-1}) \cdot \ldots \cdot (p_k^{a_k} - p_k^{a_k-1}) = $$
$$ = n \cdot \left( 1-{1\over p_1} \right) \cdot \left( 1-{1\over p_2} \right) \cdot \ldots \cdot \left( 1-{1\over p_k} \right). $$

## Реалізація

Найпростіший код, вычисляющий функцію Ейлера, факторизуя число элементарным методом за $O(\sqrt n)$:

<!--- TODO: specify code snippet id -->
``` cpp
int phi (int n) {
    int result = n;
    for (int i=2; i*i<=n; ++i)
        if (n % i == 0) {
            while (n % i == 0)
                n /= i;
            result -= result / i;
        }
    if (n > 1)
        result -= result / n;
    return result;
}
```

Ключевое місце для обчислення функції Ейлера - це знаходження **факторизації** числа $n$. Його можна осуществить за час, значно менше $O(\sqrt{n})$: див. [Эффективные алгоритми факторизації](factorization).

## Додатки функції Ейлера

Самое известное і важное властивість функції Ейлера виражається в **теоремі Ейлера**:
$$ a^{\phi(m)} \equiv 1 \pmod m, $$
де $\it a$ і $\it m$ взаємно прості.

В приватному випадку, коли $\it m$ просте, теорема Ейлера перетворюється в так звану **малу теорему Ферма**:
$$ a^{m-1} \equiv 1  \pmod m $$

Теорема Ейлера достатньо часто зустрічається в практических приложениях, наприклад, див. [Обратный елемент в поле за модулем](reverse_element).

## Задачі в online judges

Список задач, в яких потрібно порахувати функцію Ейлера,або скористатися теоремою Ейлера, або по значенням функції Ейлера відновлювати вихідне число:

* [UVA #10179 **"Irreducible Basic Fractions"** [складність: низька]](http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1120)

* [UVA #10299 **"Relatives"** [складність: низька]](http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1240)

* [UVA #11327 **"Enumerating Rational Numbers"** [складність: середня]](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=2302)

* [TIMUS #1673 **"Допуск до экзамену"** [складність: висока]](http://acm.timus.ru/problem.aspx?space=1&num=1673)
