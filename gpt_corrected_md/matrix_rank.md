# Знаходження рангу матриці

**Ранг матриці** - це найбільше число лінійно незалежних рядків/стовпців матриці. Ранг визначається не тільки для квадратних матриць; нехай матриця прямокутна і має розмір $N \times M$.

Також ранг матриці можна визначити як найбільший порядок мінорів матриці, які не дорівнюють нулю.

Зауважимо, що якщо матриця є квадратною і її визначник відмінний від нуля, то ранг дорівнює N (або M), в іншому випадку він буде меншим. У загальному випадку ранг матриці не перевищує min(N,M).

## Алгоритм

Шукати ранг можна з допомогою модифікованого [методу Гауса](linear_systems_gauss). Будемо виконувати абсолютно ті ж самі операції, що і при розв'язуванні системи або знаходженні її визначника, але якщо на якому-небудь кроці в i-ому стовпці серед невибраних до цього рядків немає ненульових елементів, то ми цей крок пропускаємо, а ранг зменшуємо на одиницю (спочатку ранг вважаємо рівним max(N,M)). Інакше, якщо ми знайшли на i-ому кроці рядок з ненульовим елементом в i-ому стовпці, то помічаємо цей рядок як вибраний і виконуємо звичайні операції віднімання цього рядка від інших.

## Реалізація

<!--- TODO: specify code snippet id -->
``` cpp
const double EPS = 1E-9;

int rank = max(n, m);
vector<char> line_used(n);
for (int i = 0; i < m; ++i) {
    int j;
    for (j = 0; j < n; ++j)
        if (!line_used[j] && abs(a[j][i]) > EPS)
            break;
    if (j == n)
        --rank;
    else {
        line_used[j] = true;
        for (int p = i + 1; p < m; ++p)
            a[j][p] /= a[j][i];
        for (int k = 0; k < n; ++k)
            if (k != j && abs(a[k][i]) > EPS)
                for (int p = i + 1; p < m; ++p)
                    a[k][p] -= a[j][p] * a[k][i];
    }
}
```