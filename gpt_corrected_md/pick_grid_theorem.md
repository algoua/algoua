# Теорема Піка. Знаходження площі решітчастого багатокутника

Многокутник без самоперетинів називається решітчастим, якщо всі його вершини знаходяться в точках з цілими числовими координатами (у декартовій системі координат).

## Теорема Піка

### Формула

Нехай дано деякий решітчастий багатокутник з ненульовою площею.

Позначимо його площу через $S$; кількість точок з цілими координатами, що лежать строго всередині багатокутника, через $I$; кількість точок з цілими координатами, що лежать на сторонах багатокутника, через $B$.

Значить справедливо співвідношення, зване **формулою Піка**:

$$
S = I + \frac{B}{2} - 1.
$$

Зокрема, якщо відомі значення $I$ та $B$ для деякого багатокутника, то його площу можна порахувати за $O(1)$, навіть не знаючи координат його вершин.

Це співвідношення було відкрите та доведене австрійським математиком Георгом Александером Піком (Georg Alexander Pick) у 1899 році.

### Доведення

Доведення виготовляється у декілька етапів: від самостійних простих фігур до довільних багатокутників

* Одиничний квадрат. Насправді, для нього $S=1$, $І=0$, $В=4$, і формула вірна.

* Довільний невироджений прямокутник має сторони, паралельні осям координат. Для доведення формули позначимо через $a$ і $b$ довжини його сторін. Тоді знаходимо: $S = ab$, $I = (a-1)(b-1)$, $B = 2(a+b)$. Підставляючи значення, переконуємося, що формула Піка є вірною.

* Прямокутний трикутник з катетами, паралельними осям координат. Для доведення зауважимо, що будь-який такий трикутник можна отримати відсіченням деякого прямокутника його діагоналлю. Позначивши через $c$ кількість цілих точок, що лежать на діагоналі, можна показати, що формула Піка виконується для такого трикутника, незалежно від значення $c$.

* Довільний трикутник. Зауважимо, що будь-який такий трикутник може бути перетворений в прямокутний трикутник, приклеюючи до його сторін прямокутні трикутники з катетами, паралельними осям координат (при цьому знадобиться не більше 3 таких трикутників). Звідси можна отримати коректність формули Піка для будь-якого трикутника.

* Довільний багатокутник. Щоб довести його триангуляцію, розіб'ємо його на трикутники з вершинами в цілих точках. Для одного трикутника ми вже довели формулу Піка. Далі, можна довести, що при додаванні до довільного багатокутника будь-якого трикутника формула Піка залишається коректною. Звідси, за індукцією, випливає, що вона вірна для будь-якого багатокутника.

## Узагальнення на вищі розмірності

На жаль, ця настільки проста і красива формула Піка погано узагальнюється на вищі розмірності.

Наглядно це продемонстрував Рив (Reeve), запропонувавши у 1957 році розглянути тетраедр (відомий тепер як **тетраедр Рива**) з наступними вершинами:

$$
A = (0,0,0),
$$

$$
B = (1,0,0),
$$

$$
C = (0,1,0),
$$

$$
D = (1,1,k),
$$

де $k$ - будь-яке натуральне число. Значить, цей тетраедр $ABCD$ при будь-якому $k$ не містить всередині жодної точки з цілими координатами, а на його кордоні лежать тільки чотири точки $A$, $B$, $C$, $D$ і ніяких інших. Таким чином, об'єм і площа поверхні цього тетраедра можуть бути різними, в той час як число точок всередині і на кордоні залишається незмінним; отже, формула Піка не допускає узагальнення навіть на тривимірний випадок.

Тим не менш, деякі подібні узагальнення на простори більшої розмірності все ж таки є - це **многочлени Ерхарта** (Ehrhart Polynomial), але вони дуже складні і залежать не лише від кількості точок всередині та на кордоні фігури.