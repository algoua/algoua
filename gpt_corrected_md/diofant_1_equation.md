# Модульне лінійне рівняння першого порядку

## Постановка завдання

Це рівняння увазі:

$$
a \cdot x = b \pmod n,
$$

де $a$, $b$, $n$ - задані цілі числа, $x$ - невідоме ціле число.

Потрібно знайти шукане значення $x$, яке лежить в інтервалі $[0, n-1]$ (оскільки на всій числовій прямій може існувати нескінченна кількість рішень, які будуть відрізнятися одне від одного на $n \cdot k$, де $k$ - будь-яке ціле число). Якщо розв'язок не єдиний, то ми розглянемо, як отримати всі розв'язки.

## Розв'язок за допомогою знаходження оберненого елемента

Розглянемо спочатку більш простий випадок - коли $a$ і $n$ **взаємно прості**. Отже, можна знайти [обернений елемент](reverse_element) числа $a$, і, помноживши на нього обидві частини рівняння, отримати розв'язок (і він буде **єдиним**):

$$
x = b \cdot a^{-1} \pmod n
$$

Тепер розглянемо випадок, коли $a$ і $n$ **не є взаємно простими**. Очевидно, розв'язок буде існувати не завжди (наприклад, $2 \cdot x = 1 \pmod 4$).

Нехай $g = {\rm НСД(a,n)}$, тобто їх [найбільший спільний дільник](euclid_algorithm) (який в даному випадку більше одиниці).

Значить, якщо $b$ не ділиться на $g$, то розв'язку не існує. Насправді, при будь-якому $x$ ліва частина рівняння, тобто $(a \cdot x) \pmod n$, завжди ділиться на $g$, тоді як права частина на нього не ділиться. Звідси випливає, що рішень немає.

Якщо $b$ ділиться на $g$, то, розділивши обидві частини рівняння на це $g$ (тобто розділивши $a$, $b$ і $n$ на $g$), ми прийдемо до нового рівняння:

$$
a^\prime \cdot x = b^\prime \pmod {n^\prime}
$$

в якому $a'$ і $n'$ вже будуть взаємно прості, а таке рівняння ми вже навчилися розв'язувати. Позначимо його розв'язок через $x'$.

Зрозуміло, що це $x'$ також буде розв'язком вихідного рівняння. Однак, якщо $g > 1$, то воно не буде єдиним розв'язком. Можна показати, що вихідне рівняння матиме $g$ рішень, які матимуть наступний вигляд:

$$
x_i = (x^\prime + i \cdot n^\prime) \pmod n,
$$

$$
i = 0 \ldots (g-1).
$$

Підводячи підсумок, можна сказати, що **кількість розв'язків** лінійного модульного рівняння дорівнює або $g = {\rm НСД}(a,n)$, або нулеві.

## Розв'язок з допомогою Розширеного алгоритму Евкліда

Наведемо наше модулярне рівняння до діофантового рівняння наступним чином:

$$
a \cdot x + n \cdot k = b,
$$

де $x$ і $k$ - невідомі цілі числа.

Спосіб розв'язання цього рівняння описаний у відповідній статті [Лінійні діофантові рівняння другого порядку](diofant_2_equation), і полягає в застосуванні [Розширеного алгоритму Євкліда](extended_euclid_algorithm).

Тут описаний спосіб отримання всіх розв'язків цього рівняння за допомогою знайденого розв'язку. Крім того, цей спосіб, якщо ретельно розглянути, абсолютно еквівалентний способу, описаному в попередньому пункті.