# Центри тяжіння багатокутників та многогранників

Центром тяжіння (або центром мас) деякого тіла називається точка, яка має ту властивість, що якщо підвісити тіло за цю точку, то воно буде зберігати своє становище.

Нижче розглянуті двовимірні та тривимірні задачі, пов'язані з пошуком різних центрів мас - в основному з точки зору обчислювальної геометрії.

У розглянутих нижче рішеннях можна виділити два основних **факти**. Перший - що центр мас системи матеріальних точок дорівнює середньому їх координат, взятим з коефіцієнтами, пропорційними їх масам. Другий факт - що якщо ми знаємо центри мас двох, що не перетинаються фігур, то центр мас їх об'єднання буде лежати на відрізку, що з'єднує ці два центри, причому він буде ділити його у тому ж відношенні, в якому маса другої фігури стоїть до маси першої.

## Двовимірний випадок: багатокутники

Насправді, кажучи про центр маси двовимірної фігури, можна мати на увазі одну з трьох наступних задач:

* Центр мас системи точок - тобто вся маса сосредоточена тільки в вершинах багатокутника.
* Центр мас каркасу - це маса багатокутника, що зосереджена в його центрі.
* Центр маси цілісної фігури - це означає, що маса багатокутника розподілена рівномірно по всій його площі.

Кожна з цих задач має свій власний розв'язок і буде розглянута нижче окремо.

### Центр маси системи точок

Це найпростіша з трьох задач, а її розв'язок - відома фізична формула центру мас системи матеріальних точок:

$$
\vec{r_c} = \frac{ \sum\limits_i \vec{r_i} ~ m_i }{ \sum\limits_i m_i },
$$

де $m_i$ - маси точок, $\vec{r_i}$ - їх радіус-вектори (що задають їх положення щодо початку координат), і $\vec{r_c}$ - шуканий радіус-вектор центру маси.

Зокрема, якщо всі точки мають однакову масу, то координати центру мас є **середнім арифметичним** координат точок. Для **трикутника** ця точка називається **центроїдом** і збігається з точкою перетину медіан:

$$
\vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r_3} }{ 3 }.
$$

Для **доведення** цих формул достатньо згадати, що рівновага досягається в такій точці $r_c$, в якій сума моментів всіх сил дорівнює нулю. У даному випадку це перетворюється на умову того, щоб сума радіус-векторів всіх точок щодо точки $r_c$, помножених на маси відповідних точок, дорівнювала нулю:

$$
\sum\limits_i \left( \vec{r_i} - \vec{r_c} \right) m_i = \vec{0},
$$

і, виходячи звідси $\vec{r_c}$, ми отримуємо необхідну формулу.

### Центр маси каркасу

Будемо вважати, для простоти, що каркас є однорідним, тобто його щільність є однаковою всюди.

Але тоді кожну сторону багатокутника можна замінити однією точкою - серединою цього відрізку (тобто центр мас однорідного відрізку є серединою цього відрізку), з масою, рівною довжині цього відрізку.

Тепер ми отримали задачу про систему матеріальних точок, і застосовуючи до неї розв'язок з попереднього пункту, ми знаходимо:

$$
\vec{r_c} = \frac{ \sum\limits_i \vec{r_i^\prime} ~ l_i }{ P },
$$

де $\vec{r_i}$ - точка-середина $i$-ої сторони багатокутника, $l_i$ - довжина $i$-ої сторони, $P$ - периметр, тобто сума довжин сторін.

Для **трикутника** можна показати твердження: ця точка є **точкою перетину бісектрис** трикутника, утвореного серединами сторін вихідного трикутника. (Щоб показати це, треба скористатися наведеною вище формулою, а потім помітити, що бісектриси ділять сторони отриманого трикутника у тих самих відношеннях, що й центри мас цих сторін).

### Центр маси є цілісною фігурою

Ми припускаємо, що маса розподілена по фігурі однорідно, тобто щільність в кожній точці фігури дорівнює одному і тому ж числу.

#### Випадок трикутника

Стверджується, що для трикутника відповіддю буде той самий **центроїд**, тобто точка, яка утворюється як середнє арифметичне координат вершин:

$$
\vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r_3} }{ 3 }.
$$

#### Випадок трикутника: доведення

Наведемо тут просте доведення, що не використовує теорію інтегралів

Першим подібне, чисто геометричне, доведення привів Архімед, але воно було дуже складним, з великою кількістю геометричних побудов. Приведене тут доведення взято зі статті Апостола та Мнацаканяна "Знаходження центроїдів легкою дорогою".

Доведення полягає в тому, щоб показати, що центр мас трикутника знаходиться на одній з медіан. Повторивши цей процес ще двічі, ми покажемо, що центр мас знаходиться в точці перетину медіан, яка є центроїдом.

Розіб'ємо даний трикутник $T$ на чотири, з'єднавши середини сторін, як показано на малюнку:

\img{centroids_1.jpg}

Чотири отримані трикутники подібні до трикутника $T$ з коефіцієнтом $1/2$.

Трикутники №1 і №2 разом утворюють паралелограм, центр мас якого $c_{12}$ знаходиться в точці перетину його діагоналей. Оскільки ця фігура симетрична щодо обох діагоналей, то її центр мас повинен лежати на кожній з двох діагоналей. Точка $c_{12}$ знаходиться посередині загальної сторони трикутників №1 і №2, а також лежить на медіані трикутника $T$

\img{centroids_2.jpg}

Нехай тепер вектор $\vec{r}$ - вектор, що проведений з вершини $A$ до центру мас $c_1$ трикутника №1, і нехай вектор $\vec{m}$ - вектор, проведений з $A$ до точки $c_{12}$ (яка, нагадаємо, є серединою сторони, на якій вона лежить):

\img{centroids_3.jpg}

Нашою метою є показати, що вектори $\vec{r}$ та $\vec{m}$ колінеарні.

Позначимо через $c_3$ та $c_4$ точки, які є центрами мас трикутників №3 та №4 відповідно. Очевидно, центром мас сукупності цих двох трикутників буде точка $c_{34}$, яка є серединою відрізка $c_3 c_4$. Більше того, вектор, що йде від точки $c_{12}$ до точки $c_{34}$, збігається з вектором $\vec{r}$. 

Шуканий центр мас $c$ трикутника $T$ лежить посередині відрізка, що з'єднує точки $c_{12}$ і $c_{34}$ (оскільки ми розбили трикутник $T$ на дві частини рівної площі: №1-№2 і №3-№4)

\img{centroids_4.jpg}

Таким чином, вектор від вершини $A$ до центроїду $c$ дорівнює $\vec{m} + \vec{r}/2$. З іншого боку, оскільки трикутник №1 подібний до трикутника $T$ з коефіцієнтом $1/2$, то цей же вектор дорівнює $2 \vec{r}$. Звідси маємо рівняння:

$$
\vec{m} + \vec{r}/2 = 2 \vec{r},
$$

звідки ми дізнаємося:

$$
\vec{r} = \frac{2}{3} \vec{m}.
$$

Таким чином, ми довели, що вектори $\vec{r}$ та $\vec{m}$ колінеарні, що означає, що шуканий центроїд $c$ лежить на медіані, що виходить з вершини $A$.

Крім того, ми довели, що центроїд ділить кожну медіану у відношенні $2:1$, враховуючи відстань від вершини.

#### Випадок многокутника

Перейдемо тепер до загального випадку - тобто до випадку **багатокутника**. Для нього такі міркування вже непридатні, тому зведемо задачу до трикутного випадку: а саме, розіб'ємо багатокутник на трикутники (тобто триангулюємо його), знайдемо центр мас кожного трикутника, а потім знайдемо центр мас, отримані центри мас трикутників.

Остаточна формула виходить наступною:

$$
\vec{r_c} = \frac{ \sum\limits_i \vec{r_i^\circ} ~ S_i }{ S },
$$

де $\vec{r_{i}}$ - центроїд $i$-го трикутника в тріангуляції заданого багатокутника, $S_{i}$ - площа $i$-го трикутника тріангуляції, $S$ - площа всього багатокутника.

Триангуляція випуклого багатокутника - тривіальна задача: для цього, наприклад, можна взяти трикутники $(r_1,r_{i-1},r_i)$, де $i = 3 \dots n$.

#### Випадок многокутника: альтернативний спосіб

З іншого боку, застосування наведеної формули не дуже зручне для **невипуклих багатокутників**, оскільки проведення їх триангуляції - сама по собі непроста задача. Але для таких багатокутників можна придумати більш простий підхід. А саме, проведемо аналогію з тим, як можна шукати площу довільного багатокутника: вибирається довільна точка $z$, а потім сумуються знакові площі трикутників, утворених цією точкою та точками багатокутника: $S = |\sum_{i=1}^n S_{z,p_i,p_{i+1}}|$. Аналогічний прийом можна застосувати і для пошуку центру мас: тільки тепер ми будемо сумувати центри мас трикутників $(z,p_i,p_{i+1})$, взятих з коефіцієнтами, пропорційними їх площам, тобто підсумкова формула для центру мас така:

$$
\vec{r_c} = \frac{ \sum\limits_i {\vec r}_{z,p_i,p_{i+1}}^\circ ~ S_{z,p_i,p_{i+1}} }{ S },
$$

де $z$ - довільна точка, $p_i$ - точки багатокутника, ${\vec r}_{z,p_i,p_{i+1}}^\circ$ - центроїд трикутника $(z,p_i,p_{i+1})$, $S_{z,p_i,p_{i+1}}$ - знакова площа цього трикутника, $S$ - знакова площа всього багатокутника (тобто $S = \sum\limits_{i=1}^{n} S_{z,p_i,p_{i+1}}$).

## Тризначний випадок: многогранники

Аналогічно двовимірній задачі, у 3D можна говорити про чотири можливі постановки задачі:

* Центр маси системи точок - вершин багатогранника.
* Центр мас каркасу - ребра багатогранника.
* Центр маси поверхні - це точка, в якій маса рівномірно розподілена по площі поверхні багатогранника.
* Центр маси сплошного багатогранника - це точка, в якій маса рівномірно розподілена по всьому многограннику.

### Центр маси системи точок

Як і в двовимірному випадку, ми можемо застосувати фізичну формулу і отримати той же результат:

$$
\vec{r_c} = \frac{ \sum\limits_i \vec{r_i} ~ m_i }{ \sum\limits_i m_i },
$$

який у випадку рівних мас перетворюється на середнє арифметичне координат всіх точок.

### Центр маси каркасу багатогранника

Аналогічно двовимірній задачі, ми просто замінюємо кожне ребро багатогранника матеріальною точкою, розташованою посередині цього ребра, і з масою, рівною довжині цього ребра. Отримавши задачу про матеріальні точки, ми легко знаходимо її розв'язок як зважену суму координат цих точок.

### Центр маси поверхні багатогранника

Кожна грань поверхні багатогранника є двовимірною фігурою, центр мас якої ми можемо знайти. Знайшовши ці центри мас і замінивши кожну грань її центром мас, ми отримаємо задачу з матеріальними точками, яку вже легко розв'язати.

### Центр маси сплошного багатогранника

#### Випадок тетраедра

Як і у двовимірному випадку, спочатку розв'яжемо найпростішу задачу - задачу для тетраедра.

Стверджується, що центр мас тетраедра співпадає з точкою перетину його медіан (медіаною тетраедра називається відрізок, проведений з його вершини в центр мас протилежної грані; таким чином, медіана тетраедра проходить через вершину і точку перетину медіан трикутної грані).

Чому це так? Тут правильні міркування, аналогічні двовимірному випадку: якщо ми розріжемо тетраедр на два тетраедри за допомогою площини, що проходить через вершину тетраедра і яку-небудь медіану протилежної грані, то обидва отримані тетраедри матимуть однаковий об'єм (т.до. трикутна грань розірветься медіаною на два трикутники рівної площі, а висота двох тетраедрів не зміниться). Повторюючи ці міркування декілька разів, отримуємо, що центр мас лежить в точці перетину медіан тетраедра.

Ця точка - точка перетину медіан тетраедра - називається його **центроїдом**. Можна показати, що вона насправді має координати, рівні середньому арифметичному координат вершин тетраедра:

$$
\vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r_3} + \vec{r_4} }{ 4 }.
$$

(це можна вивести з того факту, що центроїд ділить медіани в відношенні $1:2$)

Таким чином, між випадками тетраедра і трикутника немає принципової різниці: точка, яка дорівнює середньому арифметичному вершин, є центром мас одразу в двох постановках задачі: коли маси знаходяться тільки в вершинах, і коли маси розподілені по всій площі/об'єму. Насправді, цей результат узагальнюється на довільну розмірність: центр мас довільного симплексу є середнім арифметичним координат його вершин.

#### Випадок довільного багатогранника

Перейдемо тепер до загальної нагоди - нагоди довільного многогранника.

Знову, як і в двовимірному випадку, ми зводимо цю задачу до вже вирішеної: розбиваємо многогранник на тетраедри (тобто робимо його тетраедризацію), знаходимо центр мас кожного з них і отримуємо остаточну відповідь на задачу у вигляді зваженої суми знайдених центрів мас.