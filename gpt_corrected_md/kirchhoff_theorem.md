# Матрична теорема Кірхгофа. Знаходження кількості остовних дерев

Заданий зв'язний неорієнтований граф своєю матрицею суміжності. Кратні ребра в графі допускаються. Потрібно порахувати кількість різних остовних дерев цього графа.

Наведена нижче формула належить Кірхгофу (Kirchhoff), який довів її у 1847 році.

## Матрична теорема Кірхгофа

Візьмемо матрицю суміжності графа G, замінимо кожен елемент цієї матриці на протилежний, а на діагоналі замість елементу A<sub>i,i</sub> поставимо ступінь вершини i (якщо є кратні ребра, то в степені вершини вони враховуються зі своєю кратністю). Отже, згідно матричної теореми Кірхгофа, всі алгебраїчні доповнення цієї матриці рівні між собою, і дорівнюють кількості остовних дерев цього графа. Наприклад, можна вилучити останній рядок і останній стовпчик цієї матриці, і модуль її визначника буде дорівнювати шуканій кількості.

Определитель матриці можна знайти за O (N<sup>3</sup>) з допомогою [методу Гауса](determinant_gauss) або [методу Краута](determinant_crout).

Доведення цієї теореми досить складне і тут не наводиться (див., наприклад, Приєзжєв В.Б. "Задача про димери та теорема Кірхгофа").

## Зв'язок з законами Кірхгофа в електричному ланцюзі

Між матричною теоремою Кірхгофа та законами Кірхгофа для електричних ланцюгів є дивовижний зв'язок.

Можна показати (внаслідок закону Ома та першого закону Кірхгофа), що опір R<sub>ij</sub> між точками i та j електричної ланки дорівнює:

$$
R<sub>ij</sub> = |T<sup>(i,j)</sup>| / |T<sup>j</sup>|
$$

де матриця T отримана з матриці A <i>зворотних</i> опорів провідників (A<sub>ij</sub> - зворотне число до опору провідника між точками i і j) перетворенням, описаним у матричній теоремі Кірхгофа, а позначення T<sup>(i)</sup> позначає викреслення рядка і стовпця з номером i, а T<sup>(i,j)</sup> - викреслення двох рядків і стовпців i і j.

Теорема Кірхгофа надає цій формулі геометричний зміст.