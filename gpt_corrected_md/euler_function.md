# Функція Ойлера

## Визначення

**Функція Ейлера** $\phi (n)$ (іноді позначається як $\varphi(n)$ або ${\it phi}(n)$) - це кількість чисел від $1$ до $n$, які є взаємно простими з $n$. Іншими словами, це кількість таких чисел на відрізку $[1; n]$, найбільший спільний дільник яких з $n$ дорівнює одиниці.

Кілька перших значень цієї функції ([A000010 в енциклопедії OEIS](http://oeis.org/A000010)):

$$
\phi (1)=1,
$$

$$
\phi (2)=1,
$$

$$
\phi (3)=2,
$$

$$
\phi (4)=2,
$$

$$
\phi (5)=4.
$$

## Властивості

Три наступні прості властивості функції Ойлера - достатні, щоб навчитися обчислювати її для будь-яких чисел:

* Якщо $p$ - просте число, то $\varphi(p)=p-1$.

(Це очевидно, що будь-яке число, крім самого $p$, взаємно просте з ним).

* Якщо $p$ - просте число, $a$ - натуральне число, то $\phi (p^a)=p^a-p^{a-1}$.

Оскільки з числом $p^a$ не взаємно прості тільки числа виду $pk$ $(k \in \mathbb{N})$, яких $p^a / p = p^{a-1}$ штук.

* Якщо $a$ і $b$ є взаємно простими числами, то $\phi(ab) = \phi(a) \cdot \phi(b)$ (мультиплікативність функції Ойлера).

(Цей факт випливає з [теореми про китайський залишок](chinese_theorem). Розглянемо довільне число $z \le ab$. Позначимо через $x$ і $y$ залишки від ділення $z$ на $a$ і $b$ відповідно. Тоді $z$ взаємно просте з $ab$ тоді й тільки тоді, коли $z$ взаємно просте з $a$ і з $b$ окремо, або, що те саме, $x$ взаємно просте з $a$ і $y$ взаємно просте з $b$. Застосовуючи теорему про китайський залишок, отримуємо, що будь-яка пара чисел $x$ і $y$ $(x \le a, ~ y \le b)$ взаємно однозначно відповідає числу $z$ $(z \le ab)$, що і завершує доведення).

Звідси можна отримати функцію Ойлера для будь-якого $\it n$ через його **факторизацію** (розкладання $n$ на прості множники):

якщо

$$
n = p_1^{a_1} \cdot p_2^{a_2} \cdot \ldots \cdot p_k^{a_k}
$$

(де всі $p_i$ є простими), то

$$
\phi(n) = \phi(p_1^{a_1}) \cdot \phi(p_2^{a_2}) \cdot \ldots \cdot \phi(p_k^{a_k}) =
$$

$$
= (p_1^{a_1} - p_1^{a_1-1}) \cdot (p_2^{a_2} - p_2^{a_2-1}) \cdot \ldots \cdot (p_k^{a_k} - p_k^{a_k-1}) =
$$

$$
= n \cdot \left( 1-{1\over p_1} \right) \cdot \left( 1-{1\over p_2} \right) \cdot \ldots \cdot \left( 1-{1\over p_k} \right).
$$

## Реалізація

Найпростіший код, вычисляющий функцію Ейлера, факторизуя число элементарным методом за $O(\sqrt n)$:

<!--- TODO: specify code snippet id -->
``` cpp
int phi(int n) {
    int result = n;
    for (int i = 2; i * i <= n; ++i)
        if (n % i == 0) {
            while (n % i == 0)
                n /= i;
            result -= result / i;
        }
    if (n > 1)
        result -= result / n;
    return result;
}
```

Ключове місце для обчислення функції Ейлера - це знаходження **розкладу на прості множники** числа $n$. Його можна здійснити за час, значно менше $O(\sqrt{n})$: див. [Ефективні алгоритми розкладу на прості множники](factorization).

## Додатки функції Ейлера

Найвідоміша і найважливіша властивість функції Ейлера виражається в **теоремі Ейлера**:

$$
a^{\phi(m)} \equiv 1 \pmod m,
$$

де $\it a$ і $\it m$ є взаємно простими.

У приватному випадку, коли $\it m$ є простим, теорема Ейлера перетворюється на так звану **малу теорему Ферма**:

$$
a^{m-1} \equiv 1  \pmod m
$$

Теорема Ойлера досить часто зустрічається в практичних застосуваннях, наприклад, див. [Зворотний елемент в полі за модулем](reverse_element).

## Завдання в онлайн-суддях

Список задач, у яких потрібно порахувати функцію Ойлера, скористатися теоремою Ойлера або за значеннями функції Ойлера відновлювати вихідне число:

* [UVA #10179 **"Irreducible Basic Fractions"** [складність: низька]](http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1120)

* [UVA #10299 **"Relatives"** [складність: низька]](http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1240)

* [UVA #11327 **"Enumerating Rational Numbers"** [складність: середня]](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=2302)

* [TIMUS №1673 **"Допуск до екзамену"** [складність: висока]](http://acm.timus.ru/problem.aspx?space=1&num=1673)