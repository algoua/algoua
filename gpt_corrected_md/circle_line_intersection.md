# Перетин кола та прямої

Дана коло (координатами свого центру і радіусом) і пряма (своїм рівнянням). Потрібно знайти точки їх перетину (одна, дві, або ні однієї).

## Розв'язок

Замість формального розв'язку системи двох рівнянь підійдемо до задачі **з геометричної сторони** (причому, за рахунок цього ми отримаємо більш точний розв'язок з точки зору числової стійкості).

Припустимо, не втрачаючи узгодженості, що центр кола знаходиться у початку координат (якщо це не так, то ми перенесемо його туди, виправивши відповідну константу C у рівнянні прямої). Тобто, маємо коло з центром у (0,0) радіусу r і пряму з рівнянням Ax + By + C = 0.

Спочатку знайдемо **найближчу до центру точку** прямої - точку з координатами **(x<sub>0</sub>,y<sub>0</sub>)**. По-перше, ця точка повинна знаходитися на такій відстані від початку координат:

$$
|C|
----
sqrt(A<sup>2</sup>+B<sup>2</sup>)
$$

По-друге, оскільки вектор (A,B) є перпендикулярним до прямої, то координати цієї точки повинні бути пропорційні координатам цього вектора. Враховуючи, що відстань від початку координат до шуканої точки нам відома, нам потрібно просто нормувати вектор (A,B) до цієї довжини, і ми отримуємо:

$$
A C
x<sub>0</sub> = - ---
       A<sup>2</sup>+B<sup>2</sup>

        B C
y<sub>0</sub> = - ---
       A<sup>2</sup>+B<sup>2</sup>
$$

(Тут неочевидні тільки знаки "-" (мінус), але ці формули легко перевірити підстановкою в рівняння прямої - повинен вийти нуль)

Знаючи найближчу до центру кола точку, ми вже можемо визначити, скільки точок міститиме відповідь, і навіть дати відповідь, якщо цих точок буде 0 або 1.

Дійсно, якщо відстань від (x<sub>0</sub>, y<sub>0</sub>) до початку координат (а його ми вже виразили формулою - див. вище) є більшою за радіус, то **відповідь - нуль точок**. Якщо ця відстань дорівнює радіусу, то **відповіддю буде одна точка** - (x<sub>0</sub>,y<sub>0</sub>). А в іншому випадку точок буде дві, і їх координати нам потрібно знайти.

Отже, ми знаємо, що точка (x<sub>0</sub>, y<sub>0</sub>) знаходиться всередині кола. Шукані точки (ax,ay) і (bx,by), крім того, що повинні лежати на прямій, повинні знаходитися на однаковій відстані d від точки (x<sub>0</sub>, y<sub>0</sub>). Цю відстань легко знайти:

$$
C<sup>2</sup>
d = sqrt ( r<sup>2</sup> - --- )
                A<sup>2</sup>+B<sup>2</sup>
$$

Зауважимо, що вектор (-B,A) колінеарний прямій, тому шукані точки (ax,ay) і (bx,by) можна отримати, додавши до точки (x<sub>0</sub>,y<sub>0</sub>) вектор (-B,A), нормований до довжини d (ми отримаємо одну шукану точку), і віднімаючи цей же вектор (отримаємо ще одну шукану точку).

Остаточний розв'язок такий:

$$
d<sup>2</sup>
mult = sqrt ( --- )
              A<sup>2</sup>+B<sup>2</sup>

ax = x<sub>0</sub> + B mult
ay = y<sub>0</sub> - A mult
bx = x<sub>0</sub> - B mult
by = y<sub>0</sub> + A mult
$$

Якщо б ми вирішували цю задачу чисто алгебраїчно, то швидше за все отримали б розв'язок у другому вигляді, який дає більшу похибку. Тому "геометричний" метод, описаний тут, крім наочності, ще й більш точний.

## Реалізація

Як було вказано в описі, передбачається, що коло розташоване в початку координат.

Тому вхідні параметри - це радіус кола та коефіцієнти A, B, C рівняння прямої.

<!--- TODO: specify code snippet id -->
``` cpp
double r, a, b, c; // вхідні дані

double x0 = -a * c / (a * a + b * b), y0 = -b * c / (a * a + b * b);
if (c * c > r * r * (a * a + b * b) + EPS)
    puts("no points");
else if (abs(c * c - r * r * (a * a + b * b)) < EPS) {
    puts("1 point");
    cout << x0 << \' \' << y0 << \'\n\';
} else {
    double d = r * r - c * c / (a * a + b * b);
    double mult = sqrt(d / (a * a + b * b));
    double ax, ay, bx, by;
    ax = x0 + b * mult;
    bx = x0 - b * mult;
    ay = y0 - a * mult;
    by = y0 + a * mult;
    puts("2 points");
    cout << ax << \' \' << ay << \'\n\' << bx << \' \' << by << \'\n\';
}
```