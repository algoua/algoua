# Розширений алгоритм Євкліда

У той час, коли ["звичайний" алгоритм Євкліда](https://uk.wikipedia.org/wiki/Алгоритм_Євкліда) просто знаходить найбільший спільний дільник двох чисел $a$ і $b$, розширений алгоритм Євкліда знаходить крім НСД також коефіцієнти $x$ і $y$ такі, що:

$$
a \cdot x + b \cdot y = {\rm gcd} (a, b).
$$

тобто, він знаходить коефіцієнти, за допомогою яких НСД двох чисел можна виразити через самі ці числа.

## Алгоритм

Внести обчислення цих коефіцієнтів до алгоритму Євкліда нескладно, достатньо вивести формули, за якими вони змінюються при переході від пари $(a,b)$ до пари $(b \bmod a,a)$ (знаком "mod" ми позначаємо взяття залишку від ділення).

Отже, нехай ми знайшли розв'язок $(x_1,y_1)$ задачі для нової пари $(b\bmod a,a)$:

$$
(b \% a) \cdot x_1 + a \cdot y_1 = g,
$$

і ми хочемо отримати розв'язок $(x,y)$ для нашої пари $(a,b)`:

$$
a \cdot x + b \cdot y = g.
$$

Для цього перетворимо величину $b\%a$:

$$
b \% a = b - \left\lfloor \frac{b}{a} \right\rfloor \cdot a.
$$

Підставляючи замість $x_1$ і $y_1$ вищезазначений вираз, отримаємо:

$$
g = (b \% a) \cdot x_1 + a \cdot y_1 = \left( b - \left\lfloor \frac{b}{a} \right\rfloor \cdot a \right) \cdot x_1 + a \cdot y_1,
$$

і, виконуючи перегрупування доданків, отримуємо:

$$
g = b \cdot x_1 + a \cdot \left( y_1 - \left\lfloor \frac{b}{a} \right\rfloor \cdot x_1 \right).
$$

Порівнюючи це зі вихідним виразом над невідомими $x$ і $y$, отримуємо необхідні вирази:

$$
\cases{
x = y_1 - \left\lfloor \frac{b}{a} \right\rfloor \cdot x_1, \cr
y = x_1.
}
$$

## Реалізація

<!--- TODO: specify code snippet id -->
``` cpp

int gcd(int a, int b, int &x, int &y) {
    if (a == 0) {
        x = 0;
        y = 1;
        return b;
    }
    int x1, y1;
    int d = gcd(b % a, a, x1, y1);
    x = y1 - (b / a) * x1;
    y = x1;
    return d;
}
```

Це рекурсивна функція, яка повертає значення НСД від чисел $a$ і $b$, а також знаходить шукані коефіцієнти $x$ і $y$ у вигляді параметрів функції, які передаються за посиланням.

База рекурсії - випадок $a = 0$. Отже, НСД дорівнює $b$, і, очевидно, необхідні коефіцієнти $x$ і $y$ дорівнюють $0$ і $1$ відповідно. В інших випадках застосовується звичайний розв'язок, а коефіцієнти перераховуються за вищеописаними формулами.

Розширений алгоритм Євкліда в такій реалізації працює правильно навіть для від'ємних чисел.

## Література

* \book{Томас Кормен, Чарльз Лейзерсон, Рональд Рівест, Кліффорд Штайн}{Алгоритми: Побудова та аналіз}{2005}{cormen.djvu}