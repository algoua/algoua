# Знаходження потоку в графі, у якому кожному ребру вказано мінімальне та максимальне значення потоку

Нехай дано граф G, в якому для кожного ребра, крім пропускної здатності (максимального значення потоку уздовж цього ребра), вказано і мінімальне значення потоку, який повинен пройти по цьому ребру.

Тут ми розглянемо дві задачі: 1) потрібно знайти будь-який потік, який задовольняє всім обмеженням, і 2) потрібно знайти мінімальний потік, який задовольняє всім обмеженням.

## Розв'язок задачі 1

Позначимо через L<sub>i</sub> мінімальну величину потоку, який можливо пройти по i-му ребру, а через R<sub>i</sub> - його максимальну величину.

Зробимо в графі наступні **зміни**: додамо нове джерело S' і стік T'. Розглянемо всі ребра, у яких L<sub>i</sub> не дорівнює нулю. Нехай i - номер такого ребра, кінці цього орієнтованого ребра - вершини A<sub>i</sub> і B<sub>i</sub>. Додамо ребро (S', B<sub>i</sub>), у якому L = 0, R = L<sub>i</sub>, додамо ребро (A<sub>i</sub>, T'), у якому L = 0, R = L<sub>i</sub>. У самому i-му ребрі покладемо R<sub>i</sub> = R<sub>i</sub> - L<sub>i</sub>, а L<sub>i</sub> = 0. Нарешті, додамо в граф ребро з T до S (старого стоку і джерела), у якому L = 0, R = INF.

Після виконання цих перетворень всі ребра графа матимуть L<sub>i</sub> рівне нулю. Таким чином, ми звели цю задачу до звичайної задачі знаходження максимального потоку в модифікованому графі з новим витоком і стоком. Пояснення, чому саме максимального, можна знайти нижче.

Коректність цих перетворень зрозуміти складніше. Неформальне **пояснення** таке. Кожне ребро, у якого L<sub>i</sub> відмінне від нуля, ми замінюємо на два ребра: одне з пропускною здатністю L<sub>i</sub>, а інше - з R<sub>i</sub>-L<sub>i</sub>. Нам потрібно знайти потік, який б обов'язково наситив перше ребро з цієї пари (тобто потік уздовж цього ребра повинен бути рівним L<sub>i</sub>); друге ребро нас волнує менше - потік уздовж нього може бути будь-яким, лише б він не перевищував його пропускну здатність. Отже, нам потрібно знайти такий потік, який б обов'язково наситив деякий набір ребер. Розглянемо кожне таке ребро, і виконаємо таку операцію: підведемо до його кінця ребро з нового джерела S', підведемо ребро з його початку до стоку T', саме ребро видаляємо, а зі старого стоку T до старого джерела S проводимо ребро нескінченної пропускної здатності. Цими діями ми імітуємо той факт, що це ребро насичене - з ребра буде виходити L<sub>i</sub> одиниць потоку (ми імітуємо це за допомогою нового джерела, який подає на кінець ребра потрібну кількість потоку), а втікати в нього буде знову ж L<sub>i</sub> одиниць потоку (але замість ребра цей потік потрапить в новий стік). Потік з нового джерела протікає по одній частині графа, дотикається до старого стоку T, з нього протікає в старе джерело S, потім тече по іншій частині графа, і нарешті приходить до початку нашого ребра, і потрапляє в новий стік T'. Тобто, якщо ми знайдемо в цьому модифікованому графі максимальний потік (і в стік потрапить потрібна кількість потоку, тобто сума всіх значень L<sub>i</sub> - інакше величина потоку буде меншою, і відповіді просто не існує), то ми одночасно знайдемо потік у вихідному графі, який задовольнятиме всі обмеження мінімуму, і, звісно, всім обмеженням максимуму.

## Розв'язок задачі 2

Зауважимо, що по ребру зі старого стоку до старого джерела з пропускною здатністю INF протікає весь старий потік, тобто пропускна здатність цього ребра впливає на величину старого потоку. При достатньо великій величині пропускної здатності цього ребра (тобто INF) старий потік необмежений. Якщо ми будемо зменшувати пропускну здатність, то починаючи з деякого моменту буде зменшуватися і величина старого потоку. Але при занадто малій величині потоку стане недостатньою, щоб забезпечити виконання обмежень (на мінімальне значення потоку уздовж ребер). Очевидно, тут можна застосувати **бінарний пошук по значеннях INF**, і знайти таке її найменше значення, при якому всі обмеження ще будуть задоволені, але старий потік буде мати мінімальне значення.