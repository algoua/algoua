# Довжина про'єднання відрізків на прямої за O (N log N)

Дано N відрізків на прямої, тобто кожний відрізок задається парою координат (X1, X2). Розглянемо об'єднання цих відрізків і найдемо його довжину.

Алгоритм був запропонований Кли (Klee) в 1977 році. Алгоритм працює за O (N log N). Было доведено, що цей алгоритм є быстрейшим (асимптотично).

## Опис

Покладемо всі координати кінців відрізків в масив X і відсортуємо його по значенням координати. Дополнительное умова при сортування - при рівності координат першими повинні йти ліві кінці. Крім того, для кожного елементу масиву будемо зберігати, відноситься він до лівому або до правому кінця відрузку. Тепер пройдемося по всьому масиву, маючи лічильник C перекрывающихся відрізків. Якщо C відмінно від нуля, то до результату додаємо різницю X<sub>i</sub> - X<sub>i-1</sub>. Якщо поточний елемент відноситься до лівому кінця, то збільшуємо лічильник C, інакше зменшуємо його.

## Реалізація

<!--- TODO: specify code snippet id -->
``` cpp
unsigned segments_union_measure (const vector <pair <int,int> > & a)
{
    unsigned n = a.size();
    vector <pair <int,bool> > x (n*2);
    for (unsigned i=0; i<n; i++)
    {
        x[i*2] = make_pair (a[i].first, false);
        x[i*2+1] = make_pair (a[i].second, true);
    }

    sort (x.begin(), x.end());

    unsigned result = 0;
    unsigned c = 0;
    for (unsigned i=0; i<n*2; i++)
    {
        if (c && i)
            result += unsigned (x[i].first - x[i-1].first);
        if (x[i].second)
            ++c;
        else
            --c;
    }
    return result;
}
```
