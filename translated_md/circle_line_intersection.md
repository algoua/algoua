# Перетин кола і прямої

Дана коло (координатами свого центру і радіусом) і пряма (своїм рівнянням). Потрібно знайти точки їх перетину (одна, дві, або ні однієї).

## Розв'язок

Замість формального розв'язку системи двох рівнянь підійдемо до задачі **з геометричній сторони** (причому, за рахунок цього ми отримаємо більш точное розв'язок з точки зору численной устойчивости).

Припустимо, не втрачаючи спільності, що центр кола знаходиться в початку координат (якщо це не так, то перенесемо його туда, исправив соответствующе константу C в рівнянні прямої). тобто. маємо коло з центром в (0,0) радіусу r і пряму з рівнянням Ax + By + C = 0.

Спочатку найдемо **найближчу до центру точку** прямої - точку з деякими координатами **(x<sub>0</sub>,y<sub>0</sub>)**. По-перше, ця точка повинна перебувати на такому відстані від початку координат:

$$
|C|
----
sqrt(A<sup>2</sup>+B<sup>2</sup>)
$$

По-друге, оскільки вектор (A,B) перпендикулярен прямої, то координати цій точки повинні бути пропорційні координатам цього вектора. Враховуючи, що відстань від початку координат до шуканої точки нам відомо, нам потрібно просто нормировать вектор (A,B) до цій довжині, і ми отримуємо:

$$
A C
x<sub>0</sub> = - ---
       A<sup>2</sup>+B<sup>2</sup>

        B C
y<sub>0</sub> = - ---
       A<sup>2</sup>+B<sup>2</sup>
$$

(тут неочевидны тільки знаки \'мінус\', але ці формули легко перевірити підстановкою в рівняння прямої - повинен вийти нуль)

Знаючи найближчу до центру кола точку, ми вже можемо визначити, скільки точок буде містити відповідь, і навіть дати відповідь, якщо цих точок 0 або 1.

Дійсно, якщо відстань від (x<sub>0</sub>, y<sub>0</sub>) до початку координат (а його ми вже выразили формулою - див. вище) більше радіусу, то **відповідь - нуль точок**. Якщо це відстань рівне радиусу, то **відповіддю буде одна точка** - (x<sub>0</sub>,y<sub>0</sub>). А ось в залишився випадку точок буде дві, і їх координати нам предстоит знайти.

Отже, ми знаємо, що точка (x<sub>0</sub>, y<sub>0</sub>) лежить всередині круга. Искомые точки (ax,ay) і (bx,by), крім того що повинні належати прямої, повинні лежати на одному і тому ж відстані d від точки (x<sub>0</sub>, y<sub>0</sub>), причому це відстань легко знайти:

$$
C<sup>2</sup>
d = sqrt ( r<sup>2</sup> - --- )
                A<sup>2</sup>+B<sup>2</sup>
$$

Зауважимо, що вектор (-B,A) коллинеарен прямої, а тому шукані точки (ax,ay) і (bx,by) можна получити, додавши до точці (x<sub>0</sub>,y<sub>0</sub>) вектор (-B,A), нормированный до довжині d (ми отримаємо одну шукану точку), і вычтя цей ж вектор (отримаємо одному шукану точку).

Окончательное розв'язок таке:

$$
d<sup>2</sup>
mult = sqrt ( --- )
              A<sup>2</sup>+B<sup>2</sup>

ax = x<sub>0</sub> + B mult
ay = y<sub>0</sub> - A mult
bx = x<sub>0</sub> - B mult
by = y<sub>0</sub> + A mult
$$

Якщо б ми вирішували цю задачу чисто алгебраически, то швидше всього отримали б розв'язок в другом вигляді, яке дає бОльшую похибка. Тому "геометричний" метод, описаний тут, крім наочності, ще і більш точен.

## Реалізація

Як і було вказано в початку опису, передбачається, що коло расположена в початку координат.

Тому вхідні параметри - це радіус кола і коефіцієнти A,B,C рівняння прямої.

<!--- TODO: specify code snippet id -->
``` cpp
double r, a, b, c; // вхідні дані

double x0 = -a*c/(a*a+b*b),  y0 = -b*c/(a*a+b*b);
if (c*c > r*r*(a*a+b*b)+EPS)
    puts ("no points");
else if (abs (c*c - r*r*(a*a+b*b)) < EPS) {
    puts ("1 point");
    cout << x0 << \' \' << y0 << \'\n\';
}
else {
    double d = r*r - c*c/(a*a+b*b);
    double mult = sqrt (d / (a*a+b*b));
    double ax,ay,bx,by;
    ax = x0 + b * mult;
    bx = x0 - b * mult;
    ay = y0 - a * mult;
    by = y0 + a * mult;
    puts ("2 points");
    cout << ax << \' \' << ay << \'\n\' << bx << \' \' << by << \'\n\';
}
```
