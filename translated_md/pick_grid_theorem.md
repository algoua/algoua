# Теорема Піка. Знаходження площі решётчатого багатокутника

Многоугольник без самопересечений називається решётчатым, якщо всі його вершини знаходяться в точках з цілочисельними координатами (в декартовой системі координат).

## Теорема Піка

### Формула

Нехай дано деякий решётчатый багатокутник, з ненульовий площадью.

Позначимо його площа через $S$; кількість точок з цілочисельними координатами, лежачих строго всередині багатокутника - через $I$; кількість точок з цілочисельними координатами, лежачих на сторонах багатокутника - через $B$.

Значить справедливо співвідношення, зване **формулою Піка**:

$$
S = I + \frac{B}{2} - 1.
$$

В зокрема, якщо відомі значення I і B для деякого багатокутника, то його площа можна порахувати за $O(1)$, навіть не знаючи координат його вершин.

Це співвідношення відкрив і довів австрийский математик Георг Александр Пик (Georg Alexander Pick) в 1899 р.

### Доведення

Доведення виготовляється в декілька этапов: від самих простих фігур до довільних багатокутників:

* Единичный квадрат. Насправді, для нього $S=1$, $I=0$, $B=4$, і формула вірна.

* Довільний невырожденный прямокутник зі сторонами, паралельними осях координат. Для доведення формули позначимо через $a$ і $b$ довжини сторін прямокутника. Значить знаходимо: $S = ab$, $I = (a-1)(b-1)$, $B = 2(a+b)$. Непосредственной підстановкою убеждаемся, що формула Піка вірна.

* Прямоугольный трикутник з катетами, паралельними осях координат. Для доведення зауважимо, що будь-який такий трикутник можна получити отсечением деякого прямокутника його диагональю. Обозначив через $c$ число цілочисельних точок, лежачих на діагоналі, можна показати, що формула Піка виконується для такого трикутника, незалежно від значення $c$.

* Довільний трикутник. Зауважимо, що будь-який такий трикутник можливо бути превращён в прямокутник приклеиванием до його сторонам прямокутних трикутників з катетами, паралельними осях координат (при цим знадобиться не більш 3 таких трикутників). Звідси можна получити коректність формули Піка для будь-якого трикутника.

* Довільний багатокутник. Для доведення триангулируем його, тобто розіб'ємо на трикутники з вершинами в цілочисельних точках. Для одного трикутника формулу Піка ми вже довели. Далі, можна довести, що при додаванні до безпідставного багатокутнику будь-якого трикутника формула Піка зберігає свою коректність. Звідси по індукції випливає, що вона вірна для будь-якого багатокутника.

## Узагальнення на высшие розмірності

До сожалению, ця настільки проста і красивая формула Піка плохо узагальнюється на высшие розмірності.

Наглядно показав це Рив (Reeve), предложив в 1957 р. розглянути тетраедр (званий тепер **тетраэдром Рива**) зі следующими вершинами:

$$
A = (0,0,0),
$$

$$
B = (1,0,0),
$$

$$
C = (0,1,0),
$$

$$
D = (1,1,k),
$$

де $k$ - будь-яке натуральне число. Значить цей тетраедр $ABCD$ при будь-яких $k$ не містить всередині ні однієї точки з цілочисельними координатами, а на його кордоні - лежати тільки чотири точки $A$, $B$, $C$, $D$ і ніякі інші. Таким чином, об'єм і площа поверхні цього тетраедра можуть бути різними, в то час як число точок всередині і на кордоні - неизменны; отже, формула Піка не допускає обобщений навіть на трёхмерный випадок.

Тим не менш, деякий подобное узагальнення на пространства більшої розмірності усе ж є, - це **многочлени Эрхарта** (Ehrhart Polynomial), але вони вельми складні, і залежать не тільки від числа точок всередині і на кордоні фігури.
