# Модульное лінійне рівняння першого порядку

## Постановка задачі

Це рівняння увазі:

$$
a \cdot x = b \pmod n,
$$

де $a, b, n$ - задані цілі числа, $x$ - неизвестное ціле число.

Потрібно знайти шукане значення $x$, лежащее в відрізку $[0; n-1]$ (оскільки на всій числовий прямої, ясно, можливо існувати нескінченно багато рішень, які будуть відрізнятися один одного на $n \cdot k$, де $k$ - будь-яке ціле число). Якщо розв'язок не єдино, то ми розглянемо, як получити всі розв'язку.

## Розв'язок з допомогою знаходження Обратного елементу

Розглянемо спочатку більш простий випадок - коли $a$ і $n$ **взаємно прості**. Значить можна знайти [зворотний елемент](reverse_element) до числу $a$, і, домножив на нього обидві частини рівняння, получити розв'язок (і воно буде **єдиним**):

$$
x = b \cdot a^{-1} \pmod n
$$

Тепер розглянемо випадок, коли $a$ і $n$ **не взаємно прості**. Значить, очевидно, розв'язок буде існувати не завжди (наприклад, $2 \cdot x = 1 \pmod 4$).

Нехай $g = {\rm gcd(a,n)}$, тобто їх [найбільший загальний дільник](euclid_algorithm) (який в даному випадку більше одиниці).

Значить, якщо $b$ не ділиться на $g$, то розв'язку не існує. Насправді, при будь-якому $x$ ліва частина рівняння, тобто $(a \cdot x) \pmod n$, завжди ділиться на $g$, в то час як права частина на нього не ділиться, звідки і випливає, що рішень ні.

Якщо ж $b$ ділиться на $g$, то, розділивши обидві частини рівняння на це $g$ (тобто розділивши $a$, $b$ і $n$ на $g$), ми прийдемо до новому уравнению:

$$
a^\prime \cdot x = b^\prime \pmod {n^\prime}
$$

в якому $a^\prime$ і $n^\prime$ вже будуть взаємно прості, а таке рівняння ми вже навчилися розв'язувати. Позначимо його розв'язок через $x^\prime$.

Зрозуміло, що це $x^\prime$ буде також бути і розв'язком вихідного рівняння. Однак якщо $g > 1$, то воно буде **не єдиним** розв'язком. Можна показати, що вихідне рівняння буде мати рівне $g$ рішень, і вони будуть мати вид:

$$
x_i = (x^\prime + i \cdot n^\prime) \pmod n,
$$

$$
i = 0 \ldots (g-1).
$$

Подводя підсумок, можна сказати, що **кількість рішень** лінійного модульного рівняння рівне або $g = {\rm gcd(a,n)}$, або нулю.

## Розв'язок з допомогою Расширенного алгоритму Евкліда

Наведемо наше модулярное рівняння до диофантову уравнению наступним чином:

$$
a \cdot x + n \cdot k = b,
$$

де $x$ і $k$ - невідомі цілі числа.

Спосіб розв'язку цього рівняння описаний в відповідної статті [Линейные диофантовы рівняння іншого порядку](diofant_2_equation), і полягає він в застосуванні [Расширенного алгоритму Евкліда](extended_euclid_algorithm).

Там ж описаний і спосіб отримання всіх рішень цього рівняння по одному знайденому розв'язку, і, до речі кажучи, цей спосіб при внимательном розгляді абсолютно еквівалентний способу, описаного в попередньому пункті.
