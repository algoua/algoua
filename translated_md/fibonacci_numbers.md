# Числа Фібоначчі

## Визначення

Послідовність Фібоначчі визначається наступним чином:

$$
F_0 = 0,
$$

$$
F_1 = 1,
$$

$$
F_n = F_{n-1} + F_{n-2}.
$$

Несколько перших її членів:

$$
0, ~ 1, ~ 1, ~ 2, ~ 3, ~ 5, ~ 8, ~ 13, ~ 21, ~ 34, ~ , ~ 55, ~ 89, ~ \ldots
$$

## История

Ці числа ввёл в 1202 р. Леонардо Фібоначчі (Leonardo Fibonacci) (також відомий як Леонардо Пизанский (Leonardo Pisano)). Однак саме завдяки математику 19 века Люка (Lucas) назва "числа Фібоначчі" стало общеупотребительным.

Втім, индийские математики упоминали числа цій послідовності ще раніше: Гопала (Gopala) до 1135 р., Хемачандра (Hemachandra) - в 1150 р.

## Числа Фібоначчі в природе

Сам Фібоначчі упоминал ці числа в зв'язку з такий завданням: "Человек посадил пару кроликів в загон, окруженный зі всіх сторін стеной. Скільки пар кроликів за год можливо провести на свет ця пара, якщо відомо, що кожний месяц, починаючи зі іншого, кожна пара кроликів виробляє на свет одну пару?". Решением цій задачі і будуть числа послідовності, званої тепер в його честь. Втім, описана Фібоначчі ситуація - більше гра разума, ніж реальная природа.

Индийские математики Гопала і Хемачандра упоминали числа цій послідовності в зв'язку з кількістю ритмических рисунков, образующихся в результаті чергування долгих і кратких слогов в стихах або сильных і слабых часткою в музыке. Число таких рисунков, мають в цілому $n$ часткою, рівне $F_n$.

Числа Фібоначчі з'являються і в роботі Кеплера 1611 року, який размышлял про числах, зустрічаються в природе (робота "Про шестиугольных снежинках").

Интересен приклад растения - тысячелистника, у якого число стеблей (а значить і квіток) завжди є число Фібоначчі. Причина цього проста: будучи спершу з єдиним стеблем, цей стебель потім ділиться на два, потім від главного стебла ответвляется ще один, потім перші два стебла знову разветвляются, потім всі стебли, крім двох останніх, разветвляются, і так далі. Таким чином, кожний стебель після свого появи "пропускает" одне разветвление, а потім починає делиться на кожному рівні разветвлений, що і дає в результаті числа Фібоначчі.

Взагалі кажучи, у багатьох квітів (наприклад, лилий) число лепестков є тим або иным числом Фібоначчі.

Також в ботанике відомо явление ''филлотаксиса''. В якості прикладу можна привести расположение семечек подсолнуха: якщо подивитися зверху на їх расположение, то можна побачити одночасно дві серии спиралей (як б наложенных один на одного): одни закручены по годинний стрілкою, інші - проти. Виявляється, що число цих спиралей приблизно збігається з двома последовательными числами Фібоначчі: 34 і 55 або 89 і 144. Аналогичные факти вірні і для деяких інших квітів, а також для сосновых шишек, брокколи, ананасов, і т.д.

Для багатьох растений (по деяким даними, для 90% з них) верен і такий интересный факт. Розглянемо який-нибудь лист, і будемо спускатися від нього вниз до тих пір, поки не достигнем листа, расположенного на стебле точно так ж (тобто направленного точно в ту ж сторону). Попутно будемо вважати всі листя, попадавшиеся нам (тобто расположенные по высоте між стартовым листком і конечным), але расположенными по-іншому. Нумеруя їх, ми будемо поступово здійснювати витки навколо стебла (оскільки листя розташовані на стебле по спирали). В залежності від того, здійснювати витки по годинний стрілкою або проти, буде виходити разное число витків. Але виявляється, що число витків, совершённых нами по годинний стрілкою, число витків, совершённых проти годинний стрілки, і число встреченных листя утворюють 3 послідовних числа Фібоначчі.

Втім, випливає відзначити, що є і растения, для яких наведені вище подсчёты дадуть числа з зовсім інших послідовностей, тому не можна сказати, що явление филлотаксиса є законом, - це швидше занимательная тенденция.

## Властивості

Числа Фібоначчі мають безліччю цікавих математических властивостей.

Ось лише деякі з них:

* Співвідношення Кассини: 

$$
F_{n+1} F_{n-1} - F_n^2 = (-1)^n.
$$

* Правило "складання": 

$$
F_{n+k} = F_k F_{n+1} + F_{k-1} F_n.
$$

* З попереднього рівності при $k = n$ випливає: 

$$
F_{2n} = F_n (F_{n+1} + F_{n-1}).
$$

* З попереднього равенста по індукції можна получити, що 

$F_{nk}$ завжди кратно $F_n$.

* Правильне і протилежне до попередньому твердження:

якщо $F_m$ кратно $F_n$, то $m$ кратно $n$.

* НСД-рівність: 

$$
{\rm gcd} (F_m, F_n) = F_{{\rm gcd} (m, n)}.
$$

* За відношенню до алгоритму Евкліда числа Фібоначчі мають тим замечательным властивістю, що вони є наихудшими входными даними для цього алгоритму (див. "Теорема Ламе" в [Алгоритме Евкліда](euclid_algorithm)).

## Фибоначчиева система числення

**Теорема Цекендорфа** стверджує, що будь-яке натуральне число $n$ можна уявити єдиним чином в вигляді суми чисел Фібоначчі:

$$
N = F_{k_1} + F_{k_2} + \ldots + F_{k_r}
$$

де $k_1 \ge k_2+2$, $k_2 \ge k_3+2$,  $\ldots$,  $k_r \ge 2$ (тобто в записи не можна використовувати два сусідніх числа Фібоначчі).

Звідси випливає, що будь-яке число можна однозначно записати в **фибоначчиевой системі числення**, наприклад:

$$
9 = 8+1 = F_6 + F_1 = (10001)_F,
$$

$$
6 = 5+1 = F_5 + F_1 = (1001)_F,
$$

$$
19 = 13+5+1 = F_7 + F_5 + F_1 = (101001)_F,
$$

причому ні в якому числі не можуть йти дві одиниці поспіль.

Неважко получити і правило додавання одиниці до числу в фибоначчиевой системі числення: якщо младшая цифра рівна 0, то її замінюємо на 1, а якщо рівна 1 (тобто в наприкінці варто 01), то 01 замінюємо на 10. Потім "исправляем" запис, послідовно исправляя всюди 011 на 100. В результаті за лінійне час буде получена запис нового числа.

Перевод числа в фибоначчиеву систему числення здійснюється простим "жадібним" алгоритмом: просто перебираємо числа Фібоначчі від великих до меншим і, якщо деякий $F_k \le n$, то $F_k$ входити в запис числа $n$, і ми віднімаємо $F_k$ від $n$ і продовжуємо пошук.

## Формула для n-го числа Фібоначчі

### Формула через радикалы

Существует замечательная формула, называемая по імені французского математика Бине (Binet), хоча вона була відома до нього Муавру (Moivre):

$$
F_n = \frac{ \left( \frac{1+\sqrt{5}}{2} \right)^n - \left( \frac{1-\sqrt{5}}{2} \right)^n }{ \sqrt{5} }.
$$

Цю формулу легко довести по індукції, однак вивести її можна з допомогою понятия утворюють функцій або з допомогою розв'язку функционального рівняння.

Відразу можна замітити, що друге доданок завжди за модулем менше 1, і більш того, дуже швидко зменшується (експоненціально). Звідси випливає, що значення першого доданка дає "майже" значення $F_n$. Це можна записати в строгом вигляді:

$$
F_n = \left[ \frac{ \left( \frac{1+\sqrt{5}}{2} \right)^n }{ \sqrt{5} } \right],
$$

де квадратные дужки позначають округление до ближайшего цілого.

Втім, для практичного застосування в вычислениях ці формули мало подходят, тому що требуют дуже високою точності роботи з дробовими числами.

### Матрична формула для чисел Фібоначчі

Неважко довести матричное випливає рівність:

$$
\begin{pmatrix}
F_{n-2} & F_{n-1} \cr
\end{pmatrix} \cdot \begin{pmatrix}
0 & 1 \cr
1 & 1 \cr
\end{pmatrix} = \begin{pmatrix}
F_{n-1} & F_{n} \cr
\end{pmatrix}.
$$

Але тоді, обозначая

$$
P \equiv
\begin{pmatrix}
0 & 1 \cr
1 & 1 \cr
\end{pmatrix},
$$

отримуємо:

$$
\begin{pmatrix}
F_0 & F_1 \cr
\end{pmatrix} \cdot P^n = \begin{pmatrix}
F_{n} & F_{n+1} \cr
\end{pmatrix}.
$$

Таким чином, для знаходження $n$-го числа Фібоначчі треба звести матрицю $P$ в ступінь $n$.

Згадуючи, що піднесення матриці в $n$-ую ступінь можна осуществить за $O(\log n)$ (див. [Бинарное піднесення в ступінь](binary_pow)), виходить, що $n$-е число Фібоначчі можна легко обчислити за $O(\log n)$ c використанням тільки цілочисельній арифметики.

## Периодичность послідовності Фібоначчі за модулем

Розглянемо послідовність Фібоначчі $F_i$ по деякого модулю $p$. Доведемо, що вона є періодичної, і причому период починається з $F_1=1$ (тобто предпериод містить тільки $F_0$).

Доведемо це від противного. Розглянемо $p^2+1$ пар чисел Фібоначчі, взятих за модулем $p$:

$$
(F_1,F_2),\ (F_2,F_3),\ \ldots,\ (F_{p^2+1},F_{p^2+2}).
$$

Оскільки за модулем $p$ можливо бути тільки $p^2$ різних пар, то серед цій послідовності знайдеться як мінімум дві однакові пари. Це вже означає, що послідовність периодична.

Виберемо тепер серед всіх таких однакових пар дві однакові пари з наименьшими номерами. Нехай це пари з деякими номерами $(F_a,F_{a+1})$ і $(F_b,F_{b+1})$. Доведемо, що $a=1$. Дійсно, в іншому випадку для них знайдуться попередні пари $(F_{a-1},F_a)$ і $(F_{b-1},F_b)$, які, по властивості чисел Фібоначчі, також будуть рівні один одному. Однак це суперечить тому, що ми вибрали совпадающие пари з наименьшими номерами, що і потрібно довести.

## Література

* \book{Роналд Грэхэм, Дональд Кнут, Орен Паташник}{Конкретная математика}{1998}{graham.djvu}
