# Задача Джонсона з одним станком

Це задача составления оптимального розкладу обробки $n$ деталей на единственном верстаті, якщо $i$-ая деталь обробляється на ньому за час $t_i$, а за $t$ секунд ожидания до обробки цій деталі платится штраф $f_i(t)$.

Таким чином, задача полягає в пошуку такого переупорядочения деталей, що наступна величина (розмір штрафу) минимальна. Якщо ми позначимо через $\pi$ перестановку деталей ($\pi_1$ - номер першо] обрабатываемой деталі, $\pi_2$ - другий, і т.д)., то розмір штрафу $f(\pi)$ рівний:

$$
F(\pi) = f_{\pi_1}(0) + f_{\pi_2}(t_{\pi_1}) + f_{\pi_3}(t_{\pi_1} + t_{\pi_2}) + \ldots + f_{\pi_n}\left(\sum_{i=1}^{n-1} t_{\pi_i}\right).
$$

Іноді ця задача називається завданням однопроцессорного обслуживания множини заявок.

## Розв'язок задачі в деяких частных випадках

### Перший приватний випадок: линейные функції штрафу

Навчимося розв'язувати цю задачу в випадку, коли всі $f_i(t)$ линейны, тобто мають вид:

$$
f_i(t) = c_i \cdot t,
$$

де $c_i$ - невід'ємні числа. Зауважимо, що в цих лінійних функціях вільний член рівний нулю, т.до. в іншому випадку до відповіді зразу можна додати цей вільний член, і розв'язувати задачу з нульовим свободным членом.

Зафіксуємо деякий розклад - перестановку $\pi$. Зафіксуємо якийсь номер $i=1 \ldots n-1$, і нехай перестановка $\pi^\prime$ рівна перестановки $\pi$, в якій обменяли $i$-ый і $i+1$-ий елементи. Подивимося, на скільки при цим изменился штраф:

$$
F(\pi^\prime) - F(\pi) =
$$

легко зрозуміти, що зміни произошли тільки з $i$-им і $i+1$-им слагаемыми:

$$
= c_{\pi^\prime_i} \cdot \sum_{k=1}^{i-1} t_{\pi^\prime_k} + c_{\pi^\prime_{i+1}} \cdot \sum_{k=1}^{i} t_{\pi^\prime_k} - c_{\pi_i} \cdot \sum_{k=1}^{i-1} t_{\pi_k} - c_{\pi_{i+1}} \cdot \sum_{k=1}^{i} t_{\pi_k} =
$$

$$
= c_{\pi_{i+1}} \cdot \sum_{k=1}^{i-1} t_{\pi^\prime_k} + c_{\pi_i} \cdot \sum_{k=1}^{i} t_{\pi_k^\prime} - c_{\pi_i} \cdot \sum_{k=1}^{i-1} t_{\pi_k} - c_{\pi_{i+1}} \cdot \sum_{k=1}^{i} t_{\pi_k} =
$$

$$
= c_{\pi_i} \cdot t_{\pi_{i+1}} - c_{\pi_{i+1}} \cdot t_{\pi_i}.
$$

Зрозуміло, що якщо розклад $\pi$ є оптимальним, то будь-яке його зміна призводить до збільшення штрафу (або сохранению прежнего значення), тому для оптимального плана можна записати умова:

$$
\forall i=1 \ldots n-1 ~~~:~~ c_{\pi_i} \cdot t_{\pi_{i+1}} - c_{\pi_{i+1}} \cdot t_{\pi_i} \ge 0.
$$

Преобразуя, отримуємо:

$$
\forall i=1 \ldots n-1 ~~~:~~ \frac{ c_{\pi_i} }{ t_{\pi_i} } \ge \frac{ c_{\pi_{i+1}} }{ t_{\pi_{i+1}} }.
$$

Таким чином, **оптимальне розклад** можна получити, просто **отсортировав** всі деталі по відношенню $c_i$ до $t_i$ в зворотньому порядку.

Слід відзначити, що ми отримали цей алгоритм так называемым **перестановочным прийомом**: ми попробовали обміняти місцями два сусідніх елементу розкладу, вирахували, наскільки при цим изменился штраф, і звідси вывели алгоритм пошуку оптимального розкладу.

### Другий приватний випадок: экспоненциальные функції штрафу

Нехай тепер функції штрафу мають вид:

$$
f_i(t) = c_i \cdot e^{\alpha \cdot t},
$$

де всі числа $c_i$ невід'ємні, константа $\alpha$ позитивна.

Значить, застосовуючи аналогічним чином тут перестановочний прийом, легко получити, що деталі треба сортировать в порядку зменшення величин:

$$
v_i = \frac{ 1 - e^{ \alpha \cdot t_i } }{ c_i }.
$$

### Третий приватний випадок: однакові монотонные функції штрафу

В цим випадку вважається, що всі $f_i(t)$ збігаються з деякої функцією $\phi(t)$, яка є зростаючої.

Зрозуміло, що в цим випадку оптимально располагать деталі в порядку збільшення часу обробки $t_i$.

## Теорема Лившица-Кладова

Теорема Лившица-Кладова устанавливает, що перестановочний прийом застосуємо тільки для вищеописаних трьох частных випадків, і тільки них, тобто:

* Линейный випадок: $f_i(t) = c_i \cdot t + d_i$, де $c_i$ - невід'ємні константи,
* Экспоненциальный випадок: $f_i(t) = c_i \cdot e^{\alpha \cdot t} + d_i$, де $c_i$ і $\alpha$ - позитивні константи,
* Тождественный випадок: $f_i(t) = \phi(t)$, де $\phi$ - зростаюча функція.

Ця теорема доведена в припущенні, що функції штрафу є достатньо гладкими (існують третьи производные).

У всіх трьох випадках застосуємо перестановочний прийом, завдяки якому шукане оптимальне розклад можливо бути знайдено простий сортуванням, отже, за час $O(n \log n)$.
