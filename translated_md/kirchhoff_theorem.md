# Матрична теорема Кірхгофа. Знаходження кількості остовних дерев

Задан зв'язний неорієнтований граф своєї матрицею суміжності. Кратные ребра в графі допускаються. Потрібно порахувати кількість різних остовних дерев цього графа.

Наведена нижче формула належить Кирхгофу (Kirchhoff), який довів її в 1847 р.

## Матрична теорема Кірхгофа

Візьмемо матрицю суміжності графа G, замінимо кожний елемент цій матриці на протилежний, а на диагонале замість елементу A<sub>i,i</sub> поставимо ступінь вершини i (якщо є кратні ребра, то в степені вершини вони учитываются зі своєї кратностью). Значить, згідно матричної теоремі Кірхгофа, всі алгебраические дополнения цій матриці рівні між собою, і рівні кількості остовних дерев цього графа. Наприклад, можна вилучити останню рядок і останній стовпець цій матриці, і модуль її визначника буде рівний искомому кількості.

Определитель матриці можна знайти за O (N<sup>3</sup>) з допомогою [методу Гауса](determinant_gauss) або [методу Краута](determinant_crout).

Доведення цій теореми достатньо складно і тут не наводиться (див., наприклад, Приезжев В.Б. "Задача про димерах і теорема Кірхгофа").

## Зв'Язок з законами Кірхгофа в електричному ланцюги

Между матричної теоремою Кірхгофа і законами Кірхгофа для електричному ланцюги є удивительная зв'язок.

Можна показати (як наслідок з закона Ома і першого закона Кірхгофа), що сопротивление R<sub>ij</sub> між точками i і j електричному ланцюги рівне:

$$
R<sub>ij</sub> = |T<sup>(i,j)</sup>| / |T<sup>j</sup>|
$$

де матриця T получена з матриці A <i>зворотних</i> сопротивлений проводников (A<sub>ij</sub> - зворотнє число до сопротивлению проводника між точками i і j) перетворенням, описаним в матричної теоремі Кірхгофа, а позначення T<sup>(i)</sup> позначає вычёркивание рядка і стовпчика з номером i, а T<sup>(i,j)</sup> - вычёркивание двох стрічок і стовпців i і j.

Теорема Кірхгофа придаёт цій формулою геометричний сенс.
