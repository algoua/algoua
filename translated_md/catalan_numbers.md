# Числа Каталана

Числа Каталана - числовая послідовність, встречающаяся в удивительном числі комбінаторних задач.

Ця послідовність названа в честь бельгийского математика Каталана (Catalan), жившего в 19 веке, хоча насправді вона була відома ще Эйлеру (Euler), жившему за век до Каталана.

## Послідовність

Перші декілька чисел Каталана $C_n$ (починаючи з нульового):

$$
1,\ 1,\ 2,\ 5,\ 14,\ 42,\ 132,\ 429,\ 1430,\ \ldots
$$

Числа Каталана зустрічаються в великому кількості задач комбинаторики. **$n$-е число Каталана** - це:

* Кількість корректных дужкових послідовностей, складаються з $n$ відкривають і $n$ закрывающих дужок.
* Кількість кореневих бінарних дерев з $n+1$ листьями (вершини не пронумерованы).
* Кількість способів повністю розділити дужками $n+1$ множник.
* Кількість триангуляций выпуклого $n+2$-угольника (тобто кількість розбиття багатокутника непересічними диагоналями на трикутники).
* Кількість способів з'єднати $2n$ точок на кола $n$ непересічними хордами.
* Кількість неизоморфных полных бінарних дерев з $n$ внутренними вершинами (тобто имеющими хоча б одного сина).
* Кількість монотонних шляхів з точки $(0,0)$ в точку $(n,n)$ в квадратной решітці розміром $n \times n$, не поднимающихся над главной диагональю.
* Кількість перестановок довжини $n$, які можна відсортувати стеком (можна показати, що перестановка є сортируемой стеком тоді і тільки тоді, коли ні таких індексів $i<j<k$, що $a_k<a_i<a_j$).
* Кількість непрерывных розбиття множини з $n$ елементів (тобто розбиття на непрерывные блоки).
* Кількість способів покрити лесенку $1 \ldots n$ з допомогою $n$ прямоугольников (є в увазі фігура, що складається з $n$ стовпців, $i$-ый з яких має висоту $i$).

## Обчислення

Є дві формули для чисел Каталана: рекуррентная і аналитическая. Оскільки ми припустимо, що всі наведені вище задачі еквівалентні, то для доведення формул ми будемо вибирати ту задачу, з допомогою якій це зробити простіше всього.

### Рекуррентная формула

$$
C_n = \sum_{k=0}^{n-1} C_k C_{n-1-k}
$$

Рекуррентную формулу легко вивести з задачі про правильних дужкових послідовностях.

Самой лівої відкриває скобці l відповідає певна закриває дужка r, яка розбиває формулу дві частини, кожна з яких в свою чергу є правильної дужковій послідовністю. Тому, якщо ми позначимо $k = r-l-1$, то для будь-якого фіксованого $r$ буде рівне $C_k C_{n-1-k} $ способів. Суммируя це по всім допустимым $k$, ми і отримуємо рекурентну залежність на $C_n$.

### Аналитическая формула

$$
C_n = \frac{1}{n+1} C_{2n}^{n}
$$

(тут через $C_n^k$ обозначен, як зазвичай, [биномиальный коефіцієнт](binomial_coeff)).

Цю формулу простіше всього вивести з задачі про монотонних шляхах. Общее кількість монотонних шляхів в решітці розміром $n \times n$ рівне $C_{2n}^{n}$. Тепер порахуємо кількість монотонних шляхів, перетинають діагональ. Розглянемо який-або з таких шляхів, і найдемо перший ребро, яке варто вище діагоналі. Отразим щодо діагоналі весь шлях, идущий після цього ребра. В результаті отримаємо монотонный шлях в решітці $(n-1) \times (n+1)$. Але, з іншої сторони, будь-який монотонный шлях в решітці $(n-1) \times (n+1)$ обов'язково перетинає діагональ, отже, він отриманий як раз таким способом з какого-або (причому єдиного) монотонного шляхи, пересекающего діагональ, в решітці $n \times n$. Монотонных шляхів в решітці $(n-1) \times (n+1)$ є $C_{2n}^{n-1}$. В результаті отримуємо формулу:

$$
C_n = C_{2n}^{n} - C_{2n}^{n-1} = \frac{1}{n+1} C_{2n}^{n}
$$
